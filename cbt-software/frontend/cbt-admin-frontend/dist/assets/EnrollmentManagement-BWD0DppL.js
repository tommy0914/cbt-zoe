import{r as t,a as d,j as e}from"./index-B2ZUuq83.js";function w(){var y;const a=(y=JSON.parse(localStorage.getItem("auth")))==null?void 0:y.token,[x,b]=t.useState([]),[r,o]=t.useState(!0),[f,h]=t.useState(null),[u,n]=t.useState(null),[g,j]=t.useState(null),[i,p]=t.useState(null);t.useEffect(()=>{m()},[a]);async function m(){try{o(!0);const l=await d.get("/api/enrollment/requests",a);b(l.requests||[]),h(null)}catch(l){h(l.message||"Failed to fetch enrollment requests")}finally{o(!1)}}async function S(l){try{await d.post(`/api/enrollment/approve/${l}`,{},a),n("Enrollment approved!"),setTimeout(()=>{m(),n(null)},1500)}catch(s){n(s.message||"Failed to approve request")}}async function k(l,s=""){try{await d.post(`/api/enrollment/reject/${l}`,{reason:s},a),n("Enrollment rejected!"),setTimeout(()=>{m(),n(null)},1500)}catch(c){n(c.message||"Failed to reject request")}}async function E(){if(!g){p("Please select a file");return}const l=new FormData;l.append("file",g);try{o(!0);const s=await d.postForm("/api/enrollment/bulk-enroll",l,a);p(`âœ“ ${s.results.success.length} enrolled, ${s.results.failed.length} failed`),j(null),s.results.failed.length>0&&console.log("Failed enrollments:",s.results.failed)}catch(s){p(s.message||"Failed to process bulk enrollment")}finally{o(!1)}}return r?e.jsx("div",{className:"card",children:"Loading enrollment data..."}):e.jsxs("div",{children:[e.jsxs("div",{className:"card",style:{marginBottom:"20px"},children:[e.jsx("h4",{children:"ðŸ“¤ Bulk Enroll Students"}),e.jsx("p",{style:{fontSize:"12px",color:"#666"},children:"Upload CSV with columns: email, className (or classId)"}),e.jsx("input",{type:"file",accept:".csv,.xls,.xlsx",onChange:l=>j(l.target.files[0]),disabled:r}),e.jsx("div",{style:{marginTop:"8px"},children:e.jsx("button",{onClick:E,disabled:r,children:r?"Processing...":"Upload & Enroll"})}),i&&e.jsx("div",{style:{marginTop:"8px",color:i.includes("failed")&&!i.includes("0 failed")?"#dc2626":"#16a34a"},children:i})]}),e.jsxs("div",{className:"card",children:[e.jsx("h4",{children:"â³ Pending Enrollment Requests"}),u&&e.jsx("div",{style:{marginBottom:"12px",color:u.includes("Failed")?"#dc2626":"#16a34a"},children:u}),f&&e.jsx("div",{style:{marginBottom:"12px",color:"#dc2626"},children:f}),x.length===0?e.jsx("p",{children:"No pending enrollment requests."}):e.jsx("div",{children:x.map(l=>{var s,c,v;return e.jsxs("div",{className:"card",style:{marginBottom:"12px",padding:"12px",background:"#fffbeb",borderLeft:"4px solid #fbbf24"},children:[e.jsxs("div",{style:{marginBottom:"8px"},children:[e.jsx("strong",{children:((s=l.studentId)==null?void 0:s.name)||"Unknown"})," (",(c=l.studentId)==null?void 0:c.email,")",e.jsx("br",{}),e.jsxs("span",{style:{color:"#666",fontSize:"12px"},children:["Class: ",(v=l.classId)==null?void 0:v.name]}),e.jsx("br",{}),e.jsxs("span",{style:{color:"#999",fontSize:"11px"},children:["Requested:"," ",new Date(l.requestedAt).toLocaleString()]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("button",{onClick:()=>S(l._id),style:{background:"#16a34a"},children:"Approve"}),e.jsx("button",{onClick:()=>k(l._id),style:{background:"#dc2626"},children:"Reject"})]})]},l._id)})})]})]})}export{w as default};
