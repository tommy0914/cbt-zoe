import{r as a,j as s,a as h}from"./index-DoLby0QM.js";function y({token:d}){const[u,o]=a.useState([]),[m,c]=a.useState(!0),[r,p]=a.useState(null);async function i(){try{c(!0);const e=await h.get("/api/attempts/grading",d);e.pendingGrading&&o(e.pendingGrading)}catch(e){p(e.message||"Failed to fetch attempts for grading.")}finally{c(!1)}}return a.useEffect(()=>{i()},[d]),m?s.jsx("div",{children:"Loading..."}):r?s.jsx("div",{style:{color:"red"},children:r}):s.jsxs("div",{className:"card",style:{marginTop:20},children:[s.jsx("h4",{children:"Essays Pending Grading"}),u.length===0?s.jsx("p",{children:"No essays are currently pending grading."}):u.map(e=>{var l;return s.jsxs("div",{className:"card",style:{marginBottom:12},children:[s.jsxs("h5",{children:["Attempt by ",((l=e.userId)==null?void 0:l.username)||"Unknown User"," on ",new Date(e.startTime).toLocaleString()]}),e.userAnswers.filter(n=>!n.grade&&e.questions.some(t=>t._id===n.questionId.toString()&&t.questionType==="essay")).map(n=>s.jsx(f,{token:d,attemptId:e._id,answer:n,questions:e.questions,onGradeSubmitted:i},n.questionId))]},e._id)})]})}function f({token:d,attemptId:u,answer:o,questions:m,onGradeSubmitted:c}){const[r,p]=a.useState(""),[i,e]=a.useState(null),l=m.find(t=>t._id===o.questionId.toString());async function n(t){if(t.preventDefault(),e(null),r===""||isNaN(parseInt(r,10))){e("Please enter a valid number for the grade.");return}try{const g=await h.post("/api/attempts/grading",{attemptId:u,questionId:o.questionId,grade:parseInt(r,10)},d);g.attempt?(e("Grade submitted successfully!"),c()):e(g.message||"Failed to submit grade.")}catch(g){e(g.message||"An error occurred.")}}return l?s.jsxs("div",{style:{borderTop:"1px solid #ccc",paddingTop:12,marginTop:12},children:[s.jsx("strong",{children:"Question:"}),s.jsx("p",{children:l.questionText}),s.jsx("strong",{children:"Student's Answer:"}),s.jsx("p",{children:o.selectedAnswer}),s.jsxs("form",{onSubmit:n,children:[s.jsx("label",{children:"Grade:"}),s.jsx("input",{type:"number",value:r,onChange:t=>p(t.target.value),style:{marginLeft:8,width:80}}),s.jsx("button",{type:"submit",style:{marginLeft:8},children:"Submit Grade"}),i&&s.jsx("div",{style:{marginTop:8,color:i.includes("success")?"green":"red"},children:i})]})]}):null}export{y as default};
