import{r as n,a as h,j as e}from"./index-DoLby0QM.js";function p({token:r,placeholder:u="Search user by email",onSelect:m}){const[l,d]=n.useState(""),[c,o]=n.useState([]),[s,t]=n.useState(!1),i=n.useRef(null);return n.useEffect(()=>{if(!l){o([]);return}return i.current&&clearTimeout(i.current),i.current=setTimeout(async()=>{t(!0);try{const a=await h.get(`/api/users/search?email=${encodeURIComponent(l)}`,r);o(a&&a.users||[])}catch{o([])}finally{t(!1)}},350),()=>{i.current&&clearTimeout(i.current)}},[l,r]),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{value:l,onChange:a=>d(a.target.value),placeholder:u,style:{width:"60%"}}),s&&e.jsx("span",{style:{marginLeft:8},children:"Searchingâ€¦"}),c.length>0&&e.jsx("div",{className:"card",style:{position:"absolute",zIndex:40,width:"60%",marginTop:6},children:e.jsx("ul",{style:{listStyle:"none",padding:8,margin:0},children:c.map(a=>e.jsxs("li",{style:{padding:6,borderBottom:"1px solid #eee",cursor:"pointer"},onClick:()=>{m&&m(a),d(""),o([])},children:[e.jsx("strong",{children:a.username})," ",e.jsx("span",{style:{color:"#666",marginLeft:8},children:a.role})]},a._id))})})]})}function x({token:r}){const[u,m]=n.useState([]),[l,d]=n.useState(!1);n.useEffect(()=>{c()},[]);async function c(){d(!0);try{const s=await h.get("/api/classes",r);m(s.classes||[])}catch(s){console.error(s)}finally{d(!1)}}async function o(s,t){const i=await fetch("/api/classes/"+s+"/members/"+t,{method:"DELETE",headers:{Authorization:r?`Bearer ${r}`:""}}),a=await i.json();i.ok?c():alert(a.message||"Failed to remove member")}return l?e.jsx("div",{className:"card",children:"Loading your classes..."}):e.jsxs("div",{children:[e.jsx("h3",{children:"ðŸ‘¨â€ðŸ« My Classes"}),u.length===0&&e.jsx("div",{className:"card muted",children:"You haven't been assigned to any classes yet."}),u.map(s=>e.jsxs("div",{className:"card",style:{marginBottom:"16px"},children:[e.jsx("strong",{children:s.name}),e.jsxs("div",{style:{marginTop:8},children:["Subjects: ",(s.subjects||[]).join(", ")]}),e.jsxs("div",{style:{marginTop:8},children:["Members:",e.jsx("ul",{children:(s.members||[]).map(t=>e.jsxs("li",{children:[t.username||t._id||t," ",e.jsx("button",{onClick:()=>o(s._id,t._id||t),style:{marginLeft:8},children:"Remove"})]},t._id||t))}),e.jsx("div",{style:{marginTop:6},children:e.jsx(p,{token:r,placeholder:"Add member by email",onSelect:t=>{h.post(`/api/classes/${s._id}/members`,{userId:t._id},r).then(()=>c())}})})]})]},s._id))]})}export{x as default};
